<html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Hammerspoon docs: hs.crash module</title>
    <style type="text/css">
      a { text-decoration: none; }
      a:hover { text-decoration: underline; }
      th { background-color: #DDDDDD; vertical-align: top; padding: 3px; }
      td { width: 100%; background-color: #EEEEEE; vertical-align: top; padding: 3px; }
      table { width: 100% ; border: 1px solid #0; text-align: left; }
    </style>
    <link rel="stylesheet" href="docs.css" type="text/css" media="screen" />
  </head>
  <body>
    <header>
      <h1><a href="./index.html">docs</a> &raquo; hs.crash</h1>
      <p>Various features/facilities for developers who are working on Hammerspoon itself, or writing extensions for it. It is extremely unlikely that you should need any part of this extension, in a normal user configuration.</p>

      </header>
      <h3>API Overview</h3>
      <ul>
    
                <li>Variables - Configurable values</li>
                    <ul>
                
        <li><a href="#crashLogToNSLog">crashLogToNSLog</a></li>
        
                </ul>
                
                <li>Functions - API calls offered directly by the extension</li>
                    <ul>
                
        <li><a href="#attemptMemoryRelease">attemptMemoryRelease</a></li>
        
        <li><a href="#crash">crash</a></li>
        
        <li><a href="#crashKV">crashKV</a></li>
        
        <li><a href="#crashLog">crashLog</a></li>
        
        <li><a href="#dumpCLIBS">dumpCLIBS</a></li>
        
        <li><a href="#isMainThread">isMainThread</a></li>
        
        <li><a href="#residentSize">residentSize</a></li>
        
                </ul>
                
    </ul>
    <h3>API Documentation</h3>
    
                <h4 class="documentation-section">Variables</h4>
                

    <section id="crashLogToNSLog">
    <a name="//apple_ref/cpp/Variable/crashLogToNSLog" class="dashAnchor"></a>
    <h5><a href="#crashLogToNSLog">crashLogToNSLog</a></h5>
    <table>
        <tr>
            <th>Signature</td>
            <td><code>hs.crash.crashLogToNSLog</code></td>
        </tr>
        <tr>
            <th>Type</td>
            <td>Variable</td>
        </tr>
        <tr>
            <th>Description</td>
            <td>
                <p>A boolean value of true will log Hammerspoon&#39;s crash log with NSLog, false will silently capture messages in case of a crash. Defaults to false.</p>

            </td>
        </tr>
    </table>
    </section>

                <h4 class="documentation-section">Functions</h4>
                

    <section id="attemptMemoryRelease">
    <a name="//apple_ref/cpp/Function/attemptMemoryRelease" class="dashAnchor"></a>
    <h5><a href="#attemptMemoryRelease">attemptMemoryRelease</a></h5>
    <table>
        <tr>
            <th>Signature</td>
            <td><code>hs.crash.attemptMemoryRelease()</code></td>
        </tr>
        <tr>
            <th>Type</td>
            <td>Function</td>
        </tr>
        <tr>
            <th>Description</td>
            <td>
                <p>Attempts to reduce RAM usage of Hammerspoon</p>

<p>Parameters:</p>

<ul>
<li>None</li>
</ul>

<p>Returns:</p>

<ul>
<li>None</li>
</ul>

<p>Notes:</p>

<ul>
<li>This function will print some memory usage numbers (in bytes) to the Hammerspoon Console before and after forcing Lua&#39;s garbage collector</li>
</ul>

            </td>
        </tr>
    </table>
    </section>


    <section id="crash">
    <a name="//apple_ref/cpp/Function/crash" class="dashAnchor"></a>
    <h5><a href="#crash">crash</a></h5>
    <table>
        <tr>
            <th>Signature</td>
            <td><code>hs.crash.crash()</code></td>
        </tr>
        <tr>
            <th>Type</td>
            <td>Function</td>
        </tr>
        <tr>
            <th>Description</td>
            <td>
                <p>Causes Hammerspoon to immediately crash</p>

<p>Parameters:</p>

<ul>
<li>None</li>
</ul>

<p>Returns:</p>

<ul>
<li>None</li>
</ul>

<p>Notes:</p>

<ul>
<li>This is for testing purposes only, you are extremely unlikely to need this in normal Hammerspoon usage</li>
</ul>

            </td>
        </tr>
    </table>
    </section>


    <section id="crashKV">
    <a name="//apple_ref/cpp/Function/crashKV" class="dashAnchor"></a>
    <h5><a href="#crashKV">crashKV</a></h5>
    <table>
        <tr>
            <th>Signature</td>
            <td><code>hs.crash.crashKV(key, value)</code></td>
        </tr>
        <tr>
            <th>Type</td>
            <td>Function</td>
        </tr>
        <tr>
            <th>Description</td>
            <td>
                <p>Sets a key/value pair in any Crashlytics crash dump generated by this Hamerspoon session</p>

<p>Parameters:</p>

<ul>
<li>key - A string containing the key name of the pair</li>
<li>value - A string containing the value of the pair</li>
</ul>

<p>Returns:</p>

<ul>
<li>None</li>
</ul>

            </td>
        </tr>
    </table>
    </section>


    <section id="crashLog">
    <a name="//apple_ref/cpp/Function/crashLog" class="dashAnchor"></a>
    <h5><a href="#crashLog">crashLog</a></h5>
    <table>
        <tr>
            <th>Signature</td>
            <td><code>hs.crash.crashLog(logMessage)</code></td>
        </tr>
        <tr>
            <th>Type</td>
            <td>Function</td>
        </tr>
        <tr>
            <th>Description</td>
            <td>
                <p>Leaves a breadcrumb log message in any Crashlytics crash dump generated by this Hammerspoon session</p>

<p>Parameters:</p>

<ul>
<li>logMessage - A string containing a message to log</li>
</ul>

<p>Returns:</p>

<ul>
<li>None</li>
</ul>

<p>Notes:</p>

<ul>
<li>This is probably only useful to extension developers. If you are trying to track down a confusing crash, and you have access to the Crashlytics project for Hammerspoon (or access to someone who has access!), this can be a useful way to leave breadcrumbs from Lua in the crash dump</li>
</ul>

            </td>
        </tr>
    </table>
    </section>


    <section id="dumpCLIBS">
    <a name="//apple_ref/cpp/Function/dumpCLIBS" class="dashAnchor"></a>
    <h5><a href="#dumpCLIBS">dumpCLIBS</a></h5>
    <table>
        <tr>
            <th>Signature</td>
            <td><code>hs.crash.dumpCLIBS() -> table</code></td>
        </tr>
        <tr>
            <th>Type</td>
            <td>Function</td>
        </tr>
        <tr>
            <th>Description</td>
            <td>
                <p>Dumps the contents of Lua&#39;s CLIBS registry</p>

<p>Parameters:</p>

<ul>
<li>None</li>
</ul>

<p>Returns:</p>

<ul>
<li>A table containing all the paths of C libraries that have been loaded into the Lua runtime</li>
</ul>

<p>Notes:</p>

<ul>
<li>This is probably only useful to extension developers as a useful way of ensuring that you are loading C libraries from the places you expect.</li>
</ul>

            </td>
        </tr>
    </table>
    </section>


    <section id="isMainThread">
    <a name="//apple_ref/cpp/Function/isMainThread" class="dashAnchor"></a>
    <h5><a href="#isMainThread">isMainThread</a></h5>
    <table>
        <tr>
            <th>Signature</td>
            <td><code>hs.crash.isMainThread() -> bool</code></td>
        </tr>
        <tr>
            <th>Type</td>
            <td>Function</td>
        </tr>
        <tr>
            <th>Description</td>
            <td>
                <p>Determine if Lua execution is happening on the main thread</p>

<p>Parameters:</p>

<ul>
<li>None</li>
</ul>

<p>Returns:</p>

<ul>
<li>A boolean, true if you are on the main thread, false if not</li>
</ul>

<p>Notes:</p>

<ul>
<li>This is for testing purposes only, you are extremely unlikely to need this in normal Hammerspoon usage</li>
<li>When developing a new extension, especially one that involves handlers for outside events, this function
can be used to make sure your event handling happens on the main thread. It is extremely important that Lua
execution happen only on the main thread of Hammerspoon</li>
<li><p>You can use this Lua code to make Hammerspoon abort if anything happens on a different thread:</p>

<pre lang="lua"><code>local function crashifnotmain(reason)
  print(&quot;crashifnotmain called with reason&quot;, reason) -- may want to remove this, very verbose otherwise
  if not hs.crash.isMainThread() then
    print(&quot;not in main thread, crashing&quot;)
    hs.crash.crash()
  end
end

debug.sethook(crashifnotmain, &#39;c&#39;)
</code></pre></li>
</ul>

            </td>
        </tr>
    </table>
    </section>


    <section id="residentSize">
    <a name="//apple_ref/cpp/Function/residentSize" class="dashAnchor"></a>
    <h5><a href="#residentSize">residentSize</a></h5>
    <table>
        <tr>
            <th>Signature</td>
            <td><code>hs.crash.residentSize() -> integer or nil</code></td>
        </tr>
        <tr>
            <th>Type</td>
            <td>Function</td>
        </tr>
        <tr>
            <th>Description</td>
            <td>
                <p>Gets the resident size of the Hammerspoon process</p>

<p>Parameters:</p>

<ul>
<li>None</li>
</ul>

<p>Returns:</p>

<ul>
<li>An integer containing the amount of RAM in use by Hammerspoon (in bytes), or nil if an error occurred</li>
</ul>

            </td>
        </tr>
    </table>
    </section>

  </body>
</html>
